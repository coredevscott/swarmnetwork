import{jsx as _jsx,jsxs as _jsxs}from"react/jsx-runtime";import*as React from"react";import{addPropertyControls,ControlType}from"framer";function useFlicker(enabled){const[opacity,setOpacity]=React.useState(1);React.useEffect(()=>{if(!enabled)return;const interval=setInterval(()=>{setOpacity(Math.random()*.3+.7);},100);return()=>clearInterval(interval);},[enabled]);return enabled?opacity:1;}function useLicenseCount(objectId){const[data,setData]=React.useState({count:0,loading:true,error:null});React.useEffect(()=>{async function fetchData(){if(!objectId){setData({count:0,loading:false,error:"Object ID required"});return;}try{var _result_result_data_content,_result_result_data,_result_result;const response=await fetch("https://fullnode.mainnet.sui.io:443",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"sui_getObject",params:[objectId,{showType:true,showOwner:true,showPreviousTransaction:true,showDisplay:false,showContent:true,showBcs:false,showStorageRebate:true}]})});const result=await response.json();const fields=(_result_result=result.result)===null||_result_result===void 0?void 0:(_result_result_data=_result_result.data)===null||_result_result_data===void 0?void 0:(_result_result_data_content=_result_result_data.content)===null||_result_result_data_content===void 0?void 0:_result_result_data_content.fields;if(!fields)throw new Error("Invalid data structure");setData({count:fields.total_distribution||0,loading:false,error:null});}catch(err){setData({count:0,loading:false,error:err.message});}}fetchData();const interval=setInterval(fetchData,1e4);return()=>clearInterval(interval);},[objectId]);return data;}export default function LicenseCounter(props){const{objectId,flickerEnabled,fontName,fontSize,maxLicenses=1e4,titleSpacing=120}=props;const flickerOpacity=useFlicker(flickerEnabled);const{count,loading,error}=useLicenseCount(objectId);const ratio=Math.min(count/maxLicenses,1);const progressWidth=580*ratio;const textBase={fontFamily:fontName,fontSize:fontSize,fill:"#00FFBB",filter:"url(#neonGlow)"};return /*#__PURE__*/_jsxs("svg",{style:{opacity:flickerOpacity},width:"100%",height:"100%",viewBox:"0 0 600 300",children:[/*#__PURE__*/_jsx("defs",{children:/*#__PURE__*/_jsxs("filter",{id:"neonGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[/*#__PURE__*/_jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"4",result:"coloredBlur"}),/*#__PURE__*/_jsxs("feMerge",{children:[/*#__PURE__*/_jsx("feMergeNode",{in:"coloredBlur"}),/*#__PURE__*/_jsx("feMergeNode",{in:"SourceGraphic"})]})]})}),/*#__PURE__*/_jsx("text",{x:"50%",y:"50",style:{...textBase,fontSize:fontSize*1.3},textAnchor:"middle",children:"LICENSES SOLD"}),/*#__PURE__*/_jsx("text",{x:"50%",y:titleSpacing,style:textBase,textAnchor:"middle",children:loading?"LOADING...":error?"ERROR":count.toLocaleString()}),/*#__PURE__*/_jsx("rect",{x:"10",y:"275",width:progressWidth,height:"15",fill:"#00FFBB",style:{filter:"url(#neonGlow)"}})]});}addPropertyControls(LicenseCounter,{objectId:{type:ControlType.String,title:"Object ID",defaultValue:""},flickerEnabled:{type:ControlType.Boolean,title:"Flicker?",defaultValue:true},fontName:{type:ControlType.String,title:"Font Name",defaultValue:"monospace"},fontSize:{type:ControlType.Number,title:"Font Size",defaultValue:24,min:10,max:80,displayStepper:true},maxLicenses:{type:ControlType.Number,title:"Max Licenses",defaultValue:1e4,min:100,max:1e6,displayStepper:true},titleSpacing:{type:ControlType.Number,title:"Title Spacing",defaultValue:120,min:60,max:240,displayStepper:true}});
export const __FramerMetadata__ = {"exports":{"default":{"type":"reactComponent","name":"LicenseCounter","slots":[],"annotations":{"framerContractVersion":"1"}},"__FramerMetadata__":{"type":"variable"}}}
//# sourceMappingURL=./Sale_Counter.map